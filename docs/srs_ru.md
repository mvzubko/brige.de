# Спецификация Требований к Программному Обеспечению для Brige Service Management

## 1. Введение

### 1.1 Цель документа
Данный документ описывает функциональные и нефункциональные требования к разработке системы Brige Service Management, предназначенной для автоматизации учёта сервисных работ на объектах клиентов. 

Целью системы является упрощение процесса регистрации выполненных работ, управление заявками, хранение медиаданных и интеграция с внешними сервисами. Документ служит основой для разработки, тестирования и внедрения системы, а также для обеспечения соответствия требованиям безопасности и производительности.

### 1.2 Область применения
Система Brige Service Management будет размещена на защищённом домене и предназначена для использования только авторизованными сотрудниками компании. Основные функции системы:
- Ведение учёта и регистрации выполненных работ.
- Управление заявками, распределение задач и хранение медиаданных (изображений, документов).
- Фиксации снимков, описаний и другой информации, необходимой для анализа и планирования работ.
- Организации рабочего процесса.

### 1.3 Определения, сокращения и аббревиатуры
- SRS – Спецификация Требований к Программному Обеспечению.
- GDPR – Общий регламент защиты данных.
- SSL – Технология шифрования данных.
- API – Интерфейс для взаимодействия приложений.
- Keycloak – платформа для управления аутентификацией и авторизацией, используемая для единого SSO и разграничения доступа.
- PostgreSQL – реляционная система управления базами данных, выбранная для хранения основных данных системы.
- Redis – хранилище данных в памяти, используемое для кэширования и ускорения доступа к часто запрашиваемой информации.
- Brige Service Management – система для автоматизации и учёта работ на объектах клиентов.
- Brige Client – кроссплатформенное клиентское приложение для доступа к функционалу системы.

## 2. Общее описание системы

### 2.1 Общий взгляд на систему
Brige Service Management – это новая система, которая заменяет текущие ручные процессы управления заявками, выдачи заказ-нарядов на выполнение работ, регистрации выполненных работ и других рабочих процессов компании. 

Система будет включать в себя клиентское приложение (Brige Client) для мобильных устройств, а также администраторский интерфейс для управления пользователями и настройками системы.

В контексте данного  документа под системой понимается взаимосвязанная структура, состоящая из следующих компонентов:
  -	сервиса управления заявками, в том числе:
    -	регистрации заявок
    -	выдачи заказ-нарядов на выполнение работ исполнителям
    -	управления приоритетами и сроками выполнения заявок
    - отслеживания статуса выполнения задач
    -	анализе выполненных работ
  -	сервиса управления пользователями, в том числе:
    -	аутентификации и авторизации пользователей
    -	регистрации пользователей
    -	управления ролями и правами доступа
  -	сервиса управления работами, в том числе:
    - регистрации выполненных работ
    -	учёта использованных материалов
    -	загрузки фотографий и документов, подтверждающих выполненные работы
    -	подтверждения выполненных работ клиентами
    -	заказа материалов и оборудования
  -	сервиса управления данными, в том числе:
    -	хранения и аналитической обработки заявок, работ и медиаданных
    -	обеспечения безопасности данных (шифрование, авторизация)
  -	сервиса отчётности, в том числе:
    -	формирования отчётов по заявкам, работам и пользователям
    -	экспорта данных в различные форматы (PDF, Excel)
  -	сервиса интеграции с внешними системами, в том числе:
    -	интеграции с почтовым сервером для отправки отчётов
  -	мобильного приложения Brige Client, для IOS, Android, Windows и Linux
  -	сервиса мониторинга и логирования (вторая очередь), в том числе:
    -	мониторинга состояния системы и производительности
    -	логирования событий и ошибок для диагностики и устранения неисправностей
  -	сервиса уведомлений (вторая очередь), в том числе:
    -	отправки уведомлений пользователям о статусе заявок и выполненных работах
    -	корпоративный чат для обмена сообщениями между пользователями

Система будет разрабатываться с использованием современных технологий и подходов, включая микросервисную архитектуру, контейнеризацию и облачные решения. Основное внимание будет уделено безопасности, производительности и удобству использования.

### 2.2. Классы и характеристики пользователей
| Класс пользователей | Описание |
| ------------------- | -------- |
| ***Клиент (обычный)*** | Клиент - это авторизованный пользователь ПО Brige Client, который может самостоятельно регистрировать заявки на выполнение работ в системеме, отслеживать прогресс их выполнения, а также подтвержать фактическое выполнение работ и оставлять отзывы. |
| ***Сервисный техник*** | Сервисный техник - это авторизованный пользователь ПО Brige Client, который получает заявки на выполнение сервисных работ и может регистрировать выполненные работы, загружать медиаданные, изменять статус заявки, оформлять заявки руководству компании на сырье и материалы, необходимые для выполнения работ |
| ***Менеджер по продажам*** | Менеджер по продажам - это авторизованный пользователь ПО Brige Client, который занимается исследованием потребностей клиентов, предлагает решения и услуги компании, а также может регистрировать заявки на выполнение работ. |
| ***Оператор*** | Оператор - это авторизованный пользователь ПО Brige Client, который имеет доступ к административной части ПО и может управлять пользователями, настраивать права доступа, просматривать отчёты и статистику по выполненным работам. Оператор также рассматривает заявки на выполнение работ, распределяет их между сервисными техниками и контролирует их выполнение, а также может взаимодействовать с клиентами для уточнения деталей заявок и получения обратной связи. |
| ***Администратор*** | Администратор - это авторизованный пользователь, который имеет полный доступ к системе, включая управление пользователями, настройку интеграции с внешними сервисами, мониторинг состояния системы и управление безопасностью. Администратор также отвечает за техническую поддержку и решение проблем пользователей. |

### 2.3 Операционная среда
Операционная среда, на которой развернута система, должна удовлетворять следующим требованиям:

#### OC-1. Операционная система 
Система будет работать на современных операционных системах, таких как Linux (например, Ubuntu, CentOS) для серверной части и Android, iOS, Windows и Linux для клиентского приложения Brige Client.
#### OC-2. Среда запуска приложений
Система будет развернута на сервере с поддержкой современных веб-технологий, включая поддержку HTTPS и SSL для обеспечения безопасности передачи данных. 
#### OC-3. База данных
Система будет использовать PostgreSQL в качестве основной базы данных для хранения заявок, работ, пользователей и медиаданных. Redis будет использоваться для кэширования часто запрашиваемой информации и ускорения доступа к данным.
#### OC-4. Веб-сервер
Система будет использовать собственный веб-сервер, либо Nginx или Apache, в качестве обратного прокси-сервера для обработки входящих запросов и маршрутизации их к соответствующим микросервисам. Веб-сервер будет настроен для работы с HTTPS и SSL, обеспечивая безопасность передачи данных между клиентами и сервером.
#### OC-5. Мобильное приложение Brige Client
Brige Client будет разработан с использованием Flutter, что обеспечит кроссплатформенность и возможность работы на Android, iOS, Windows и Linux. 
#### OC-6. Контейнеризация и оркестрация
Система будет развернута в контейнерах с использованием Docker, что обеспечит изоляцию сервисов и упрощение процесса развертывания. Kubernetes будет использоваться для оркестрации контейнеров, управления масштабированием и обеспечения высокой доступности системы.
#### OC-7. Интерфейсы обмена данными
Система будет интегрирована с корпоративными сервисами почты и др. через RESTful API. Для межсервисного взаимодействия будет использоваться gRPC или REST API, что обеспечит гибкость и масштабируемость системы.
#### OC-8. Безопасность
Система будет размещена на защищённом домене с использованием SSL-сертификатов для шифрования данных. Авторизация пользователей будет осуществляться через Keycloak, что обеспечит централизованное управление пользователями и поддержку SSO (единой точки входа). Все данные будут храниться в соответствии с требованиями GDPR, включая шифрование персональных данных (при их наличии в системе) и ограничение доступа к ним.
#### OC-9. Мониторинг и логирование
Система будет включать сервис мониторинга и логирования, который будет отслеживать состояние системы, производительность и ошибки. Логи будут храниться в централизованном хранилище для последующего анализа и диагностики проблем. Для мониторинга состояния системы будет использоваться Prometheus или аналогичный инструмент, а для визуализации данных - сервис Grafana.

### 2.4 Предположения и зависимости
- Система должна быть доступна только авторизованным пользователям.
- Приложение Brige Client нормально функционирует только при условии, что серверная часть системы нормально функционирует и доступна посресредством сети Интернет.
- Пользователи должны иметь стабильное интернет-соединение для работы с системой в момент загрузки медиаданных и синхронизации данных.
- На устройствах пользователей должно быть достаточно свободного места для хранения данных приложения Brige Client, включая медиаданные.

### 2.5 Ограничения
- Система должна быть доступна только через защищённый веб-интерфейс (SSL-шлюз).
- Авторизация пользователей осуществляется по логину и паролю.
- Обработка и хранение данных должны соответствовать требованиям европейских стандартов.
- Система должна обеспечивать возможность работы в офлайн-режиме для мобильного клиента Brige Client, с последующей синхронизацией данных при восстановлении соединения.
- Работа системы не должна приводить к значительному расходу заряда батареи мобильных устройств, особенно в офлайн-режиме и при слабом покрытии сети. 

## 3. Функциональные требования
### 3.1 Регистрация заявок
#### 3.1.1 Состав функционала
- Система должна обеспечивать автоматическую генерацию уникального номера обращения/заказа при её создании.
- Пользователи с ролью "Оператор", либо "Менеджер по продажам" должны иметь возможность вводить данные о заявке, включая:
  - ***Имя клиента** (не понятно что подразумевается под именем клиента, возможно это ФИО контактного лица или имя компании, возможно сущесвуют клиенты физлица и юрлица)???*
  - Наименование компании клиента
  - Адрес клиента
  - Контактное лицо клиента
  - Контактный номер клиента
- Пользователи с ролью "Оператор" должны иметь возможность вводить данные о сервисном технике, включая:
  - Имя техника
  - Название компании (BRIGE, BRIGE Service UG, Conveyor System UG и т.д.)
  - Планируемая дата визита
  - Планируемое время прибытия 
- Система должна поддерживать возможность выбора типа планируемой работы:
  - Установка
  - Ремонт
  - Техническое обслуживание
  - Осмотр
  - Коммерческий визит
  - Консультация
  - Другое (с возможностью ввода текстового описания)
#### 3.1.2 Детальное описание функционала
---
| Функция | Описание |
| ------- | -------- |
| **Заявка.Создание\*** |  |
| &nbsp;&nbsp;&nbsp;&nbsp;.ПроверкаРегистрации | Система должна проверить, зарегистрирован ли пользователь в базе. |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.НетРегистрации | Если пользователь не зарегистрирован, система предлагает следующие варианты: </br>&nbsp;&nbsp; - Зарегистрироваться сейчас. </br>&nbsp;&nbsp; - Продолжить оформление заявки с ограниченным функционалом. </br>&nbsp;&nbsp; - Отменить оформление заявки. |
| &nbsp;&nbsp;&nbsp;&nbsp;.ДанныеКлиента | Заполнение данных клиента. |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.НаименованиеКлиента: | Ввод наименования компании-клиента с возможностью выбора из списка (для уже существующих клиентов) или ввода нового значения (для новых клиентов). |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.АдресКлиента | Ввод адреса клиента с автоматической проверкой формата (например, наличие города, улицы и номера дома). |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.КонтактноеЛицо | Ввод ФИО контактного лица. |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.КонтактныйНомер | Контактный номер телефона клиента с проверкой на корректный формат. |
| &nbsp;&nbsp;&nbsp;&nbsp;.ДанныеСервисногоТехника* | Заполнение данных сервисного техника |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.КомпанияТехника | Выпадающий список с доступными компаниями (BRIGE, BRIGE Service UG, Conveyor System UG и т.д.). | 
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ВыборТехника | Выпадающий список с доступными сервисными техниками, выбранной компании. |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ДатаВизита | Выбор даты визита через календарь с проверкой на актуальность даты. |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ВремяПрибытия | Ввод предполагаемого времени прибытия в формате HH:MM с валидацией корректности введенных данных. |
| &nbsp;&nbsp;&nbsp;&nbsp;.ТипРаботы | Пользователь выбирает тип планируемой работы через чекбоксы: </br>&nbsp;&nbsp; - Установка </br>&nbsp;&nbsp; - Ремонт </br>&nbsp;&nbsp; - Техническое обслуживание </br>&nbsp;&nbsp; - Осмотр </br>&nbsp;&nbsp; - Коммерческий визит </br>&nbsp;&nbsp; - Консультация </br>&nbsp;&nbsp; - Другое |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ВыбраноДругое | Появляется текстовое поле для детального описания типа работы. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Подтверждение | Пользователь подтверждает введенные данные и отправляет заявку на обработку. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Уведомление | Система отправляет уведомление о создании заявки и сохраняет заявку в базе данных. |

---
\* Заявка.Создание может быть реализована в двух вариантах:
- **Вариант 1**: Пользователи с ролью "Оператор" или "Менеджер по продажам" могут создавать заявки, вводя необходимые данные о клиенте и сервисном технике, типе работы и планируемой дате визита.
- **Вариант 2**: Пользователи с ролью "Клиент" могут создавать заявки, вводя необходимые данные о себе и типе работы, которую они хотят заказать.

### 3.2 Регистрация выполненных работ
#### 3.2.1 Состав функционала
- Система должна позволять пользователям с ролью "Сервисный техник" регистрировать выполненные работы, включая текстовое описание, использованные материалы и дополнительные задачи.
- Система должна поддерживать возможность указания срочности дополнительных работ (низкая, средняя, высокая, критическая).
- Система должна поддерживать возможность загрузки медиаданных (фотографий, документов) для подтверждения выполненных работ.
- Система должна автоматически фиксировать время начала и завершения работы.
#### 3.2.2 Детальное описание функционала
| Функция                          | Описание |
| -------------------------------- | -------- |
| **Работа.Регистрация**           | Детальное оформление процесса регистрации выполненных работ. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Старт   | Пользователь с ролью "Сервисный техник" нажимает кнопку "Начать работу".<br>- Система автоматически сохраняет время начала работы.<br>- Фиксируется геолокация (при наличии разрешения).<br>- Запускается таймер для отслеживания продолжительности работы. <br>- Система меняет статус заявки на "В работе". |
| &nbsp;&nbsp;&nbsp;&nbsp;.ОписаниеРабот | Пользователь указывает этапы выполненной работы и особенности исполнения.<br>Поддерживается базовое форматирование текста. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Материалы | Заполнение раздела об использованных материалах.<br>- Пользователь выбирает материалы из выпадающего списка или вводит новые данные вручную.<br>- Система предлагает автозаполнение для часто используемых материалов. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Задачи   | Заполнение данных о дополнительных задачах, связанных с выполненной работой.<br>- Ввод описания дополнительной задачи.<br>- Выбор срочности задачи (Низкая, Средняя, Высокая, Критическая).<br>- Возможность добавления нескольких задач. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Медиа    | Загрузка медиаданных для подтверждения выполненной работы.<br>- Возможность множественной загрузки изображений и документов.<br>- Система проверяет формат и размер файлов, выводит сообщения об ошибках, если обнаружены несоответствия. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Пауза    | При необходимости пользователь может временно приостановить регистрацию работы.<br>- Выбор опции "Пауза" и ввод причины (например, ожидание материалов или техническая проблема).<br>- Система останавливает таймер и сохраняет время паузы. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Продолжение | После устранения причины паузы пользователь нажимает "Продолжить работу".<br>- Система возобновляет таймер с учетом ранее прерванного времени. |
| &nbsp;&nbsp;&nbsp;&nbsp;.Завершение  | По окончании работы пользователь фиксирует её завершение.<br>- Система автоматически сохраняет время окончания работы и рассчитывает общее время выполнения.<br>- Заявка переводится в статус "Выполнено". |

</br></br></br></br></br></br>
| Функция | Описание |
| ------- | -------- |
| Работа.Старт | Пользователи с ролью "Сервисный техник" фиксируют начало работы, меняя статус заявки на "В работе", при этом система автоматически сохраняет время начала работы и геолокацию (если доступно) и запускает таймер для отслеживания времени выполнения работы. |
| Работа.Описание | Пользователи с ролью "Сервисный техник" могут вводить текстовое описание выполненных работ, включая детали и особенности выполнения работы. |
| Работа.Материалы | Пользователи с ролью "Сервисный техник" могут выбирать и указывать использованные материалы из предустановленного списка или вводить новые материалы вручную. |
| Работа.Задачи | Пользователи с ролью "Сервисный техник" могут указывать дополнительные задачи, которые необходимо выполнить, и их срочность (низкая, средняя, высокая, критическая). |
| Работа.Медиа | Пользователи с ролью "Сервисный техник" могут загружать фотографии и документы, описывающие возможные проблемы, выполненные работы и другие важные аспекты. |
| Работа.Пауза | Пользователи с ролью "Сервисный техник" могут приостанавливать работу, если это необходимо, при этом указывая причину паузы (например, ожидание материалов, технические проблемы и т.д.). Система останавливает таймер. |
| Работа.Продолжение | Пользователи с ролью "Сервисный техник" могут продолжать работу после паузы, при этом система возобновляет таймер. |
| Работа.Завершение | Пользователи с ролью "Сервисный техник" фиксируют завершение работы, при этом система автоматически сохраняет время завершения работы и рассчитывает общее время выполнения работы. |

### 3.3 Подтверждение выполненной работы
#### 3.3.1 Состав функционала
- Система должна предоставлять форму для подтверждения успешности выполнения работы, включая возможность ввода комментариев клиента.
- Система должна поддерживать получение цифровой подписи клиента для подтверждения выполненных работ.
#### 3.3.2 Детальное описание функционала
| Функция | Описание |
| ------- | -------- |
| Подтверждение | Система предоставляет форму для подтверждения выполненной работы, где клиент может указать, была ли работа успешно выполнена (Да/Нет), оставить комментарии и ввести своё имя для подписи. |


### 3.4 Отправка отчётов
- Система должна автоматически отправлять заполненные формы и отчёты на сервер, а также на указанный корпоративный адрес *info@brige.de*.
### 3.5 Формирование отчётов и аналитика
- Система должна предоставлять возможность формирования отчётов по заявкам, выполненным работам и пользователям за определённый период времени.
- Система должна поддерживать экспорт данных в различные форматы (PDF, Excel) для дальнейшего анализа и отчётности.
### 3.6 Администрирование и управление пользователями
- Система должна предоставлять администраторский интерфейс для управления пользователями, ролями и правами доступа.
- Система должна обеспечивать мониторинг состояния системы, производительности и логирование событий для диагностики и устранения неисправностей.
- Система должна поддерживать интеграцию с корпоративными сервисами почты для отправки уведомлений и отчётов.



---
Работа продолжается - ниже пока не смотреть - там заготовки
---











### 2.3 Пользовательские характеристики
- **Клиентский доступ (Brige Client):** 
  - Сервисные техники, менеджеры и другие конечные пользователи используют Brige Client для регистрации заявок, фиксирования выполненных работ и загрузки медиаданных.
  - Доступ предусматривает функционал ввода, просмотра отчётов и работу в офлайн-режиме с последующей синхронизацией.
- **Администраторский доступ:**  
  - Администраторы системы, ответственные за управление пользователями, контроль доступа, настройку интеграции с внешними сервисами и мониторинг состояния системы.
  - Админская панель обеспечивает расширенный функционал для управления системой, конфигурации Keycloak и аварийного восстановления.

### 2.4 Ограничения системы
- Доступ к системе осуществляется только через защищённый веб-интерфейс (SSL-шлюз).
- Авторизация пользователей осуществляется по паролю или с использованием корпоративных механизмов SSO (например, с использованием Keycloak).
- Обработка и хранение данных должна соответствовать требованиям GDPR.
- Высокая нагрузка не должна приводить к значительному замедлению производительности (время отклика не более 3 секунд).

### 2.5 Предположения и зависимости
- Пользователи обладают стабильным интернет-соединением (при этом Brige Client должен корректно обрабатывать ситуации отсутствия или слабого сигнала).
- Серверное оборудование соответствует современным стандартам безопасности и производительности.
- Система интегрирована с корпоративными сервисами почты, CRM и ERP.

## 3. Специфические требования

### 3.1 Функциональные требования

#### 3.1.1 Регистрация заявок и ввод данных
- Автоматическая генерация уникального номера заявки.
- Ввод информации о клиенте: имя, контактные данные, адрес.
- Ввод информации о сотруднике: имя, должность, время начала и завершения работы.
- Возможность выбора типа работы (например, установка, ремонт, техническое обслуживание, осмотр, коммерческий визит, консультация, другое).

#### 3.1.2 Детальное описание выполненных работ
- Текстовое поле для описания выполненных работ.
- Возможность выбора и указания использованных материалов.
- Опция постановки дополнительных задач с возможностью указания срочности (низкая, средняя, высокая, критическая).

#### 3.1.3 Загрузка медиаданных
- Загрузка изображений выполненных работ с возможностью множественной загрузки.
- Загрузка дополнительных документов (PDF, DOCX, Excel).

#### 3.1.4 Подтверждение выполненных работ
- Форма для подтверждения успешности выполнения работы.
- Ввод комментариев клиента и получение цифровой подписи.

#### 3.1.5 Отправка и архивирование данных
- Автоматическая отправка заполненной формы на корпоративный адрес.
- Опция формирования PDF-отчёта для внутреннего архивирования.

#### 3.1.6 Работа в офлайн-режиме мобильного клиента (Brige Client)
- Brige Client должен обеспечивать возможность работы в офлайн-режиме при отсутствии интернет-соединения.
- Локальное хранение данных (например, с использованием SQLite, Hive или аналогичного решения) для записи введенной информации до её синхронизации с сервером.
- Автоматическая или ручная синхронизация данных с сервером при восстановлении соединения, с применением механизмов разрешения конфликтов, если они возникают.

### 3.2 Нефункциональные требования

#### 3.2.1 Безопасность
- Размещение системы на защищённом домене с использованием SSL.
- Авторизация пользователей (пароль или SSO) с интеграцией Keycloak для централизованного управления пользователями.
- Ограничение доступа согласно ролям (клиентский доступ для Brige Client и администраторский доступ для управления системой).
- Соответствие требованиям GDPR для хранения и обработки персональных данных.
- Защита от несанкционированного доступа.

#### 3.2.2 Производительность
- Быстрый отклик системы (не более 3 секунд).
- Поддержка одновременной работы множества пользователей.

#### 3.2.3 Удобство использования
- Интуитивно понятный интерфейс с минимальным количеством шагов.
- Адаптивный дизайн для корректного отображения на любых устройствах.
- Эффективная навигация между разделами системы.

#### 3.2.4 Надёжность
- Регулярное резервное копирование всех данных.
- Логирование событий и ошибок для быстрого устранения неисправностей.
- Возможность восстановления данных в случае сбоев.

#### 3.2.5 Энергоэффективность
- Brige Client должен быть оптимизирован для минимального расхода заряда батареи, особенно в режиме офлайн и при слабом покрытии сети.
- Фоновые процессы синхронизации должны выполняться с минимальным воздействием на потребление энергии.

### 3.3 Требования к интерфейсам

#### 3.3.1 Пользовательский интерфейс
- Современный, минималистичный дизайн с акцентом на удобство ввода данных.
- Экраны ввода, кнопки, выпадающие списки и чекбоксы, оптимизированные под мобильные устройства.
- Интерфейс Brige Client, разработанного на Flutter, должен быть интуитивно понятным и согласованным со схемой дизайна для десктопных и веб-платформ.
- Админский интерфейс должен предоставлять расширенный функционал для управления пользователями, настройками системы (включая конфигурацию Keycloak) и мониторинга.

#### 3.3.2 Интеграция и API
- API для взаимодействия с корпоративной CRM и ERP системами.
- Интеграция с почтовым сервером для автоматической отправки отчётов.
- Возможность экспорта данных в формате PDF для архивирования.

## 4. Системные и аппаратные требования
- Сервер с установленным SSL-сертификатом.
- Совместимость с современными веб-браузерами (Chrome, Firefox, Edge, Safari).
- Выделенные ресурсы для обеспечения высокой производительности.
- Мобильная совместимость для корректной работы на смартфонах и планшетах.
- Сервер и инфраструктура должны поддерживать синхронизацию данных из офлайн-режима Brige Client.

## 5. План реализации и тестирования

### 5.1 Этапы разработки
- Сбор и анализ требований.
- Разработка макета и составление прототипа интерфейса.
- Реализация функционала регистрации заявок, ввода данных и загрузки файлов.
- Интеграция с почтовым сервером и корпоративными API.
- Реализация механизма офлайн-работы Brige Client и синхронизации данных.
- Внедрение разграничения доступа с клиентскими и администраторскими учетными записями.
- Интеграция Keycloak для управления пользователями и единой аутентификации.
- Развертывание микросервисов в контейнерах (например, Docker) с оркестрацией с помощью Kubernetes.
- Проведение функционального тестирования и устранение обнаруженных ошибок.
- Тестирование производительности, безопасности, энергоэффективности и удобства использования.
- Развертывание системы на защищённом домене и ввод в эксплуатацию.

### 5.2 Тестирование
- Функциональное тестирование всех ключевых сценариев (регистрация, редактирование, отправка).
- Тестирование безопасности (проверка авторизации, разграничения доступа, защиты данных, интеграции с Keycloak и соответствия требованиям GDPR).
- Нагрузочное тестирование при высокой одновременной активности пользователей.
- Тестирование механизма офлайн-синхронизации, включая сценарии разрешения конфликтов.
- Тестирование энергоэффективности Brige Client, с оценкой влияния фоновых процессов на расход батареи.
- Интеграционное тестирование взаимодействия с внешними API и почтовой системой.
- Тестирование процессов развертывания и обновления микросервисов в Kubernetes.

## 6. Приложения

### 6.1 Дополнительные документы
- Примеры заполнения форм и отчётов.
- Диаграммы бизнес-процессов и пользовательских сценариев.
- Список терминов и сокращений, используемых в документе.

## 7. Технический стэк и архитектурное решение

В качестве основы для реализации системы предлагается следующий подход:

### 7.1 Общая архитектура

Система построена на основе трёхуровневой архитектуры, которая включает следующие компоненты:

1. **Клиентский уровень (Presentation Layer, frontend)**:
   - Это пользовательский интерфейс, через который сотрудники компании взаимодействуют с системой - мобильное приложение Brige Client.
   - Основная задача клиента — отправка данных на обработку и отображение результатов работы системы.
   - Brige Client будет поддерживать режим офлайн с локальным хранением данных и последующей синхронизацией с сервером.
   - Рекомендуется применение одного из современных подходов к управлению состоянием (Provider, BLoC или Riverpod) для обеспечения чистой архитектуры приложения.
   - Особое внимание уделяется оптимизации энергопотребления, чтобы приложение не разряжало батарею, особенно при слабом покрытии сети.   
   - Клиентское приложение рекомендуется разрабатывать с использованием Flutter. Flutter позволит создать единое решение для мобильных устройств (Android, iOS), а также для десктопных систем (Windows, Linux) и веб-интерфейса.

2. **Серверный уровень (Application Layer, backend)**:
   - Сердце системы, где выполняется основная логика обработки данных.
   - Включает в себя микросервисы, разработанные на Go (Golang), которые выполняют отдельные задачи, такие как:
     - Управление заявками.
     - Загрузка и обработка медиафайлов.
     - Интеграция с внешними системами (CRM, ERP и почтовыми сервисами).
     - Управления пользователями с разграничением доступа по ролям.
   - Golang выбран за его высокую производительность, встроенную поддержку конкурентности и простоту развертывания в контейнерах.
   - Микросервисы разворачиваются в контейнерах (например, с использованием Docker) с дальнейшей оркестрацией и управлением через Kubernetes. Это решение обеспечивает автономность, масштабируемость и лёгкость обновления отдельных сервисов.
   - Для взаимодействия между микросервисами рекомендуется использовать протокол gRPC для эффективной и быстрой коммуникации или REST API для интеграции с внешними сервисами.
   - Интеграция Keycloak для управления пользователями, реализации единого входа (SSO) и разграничения доступа.
   - Keycloak позволяет централизованно управлять аутентификацией и авторизацией для всех микросервисов и клиентских приложений.

3. **Уровень базы данных (Database Layer)**:
   - Здесь хранятся все данные системы, включая заявки, файлы и пользовательскую информацию.
   - База данных оптимизирована для высокой производительности и масштабируемости, чтобы справляться с большими объёмами информации.
   - Основные компоненты:
     - Реляционная БД PostgreSQL для хранения структурированных данных о заявках, клиентах, пользователях
     - Объектное хранилище MinIO для эффективного хранения медиафайлов (фотографии, документы)
     - TimescaleDB для хранения временных рядов (метрики, логи, аналитика)
   - Стратегия репликации и шардирования данных для обеспечения высокой доступности и горизонтальной масштабируемости

### 7.2 Управление пользователями и безопасность

- **Централизованное управление идентификацией**:
  - Keycloak как основа системы управления пользователями и их доступом (IAM)
  - Интеграция с корпоративными каталогами (LDAP, Active Directory) для единого входа
  - Поддержка многофакторной аутентификации для повышенной безопасности
  - Возможность федеративной аутентификации через SAML, OAuth 2.0, OpenID Connect
  - Настраиваемые потоки аутентификации для разных категорий пользователей

- **Ролевая модель доступа**:
  - Основные роли: администратор, руководитель, техник, клиент
  - Дополнительные роли: аналитик, диспетчер, аудитор, менеджер по продажам
  - Гранулярные разрешения на уровне отдельных функций системы
  - Контекстно-зависимые разрешения (например, доступ только к своим заявкам или ко всем заявкам отдела)

- **Защита данных**:
  - Шифрование данных в состоянии покоя (data at rest) для конфиденциальной информации
  - Полное шифрование канала связи (TLS 1.3) для всех коммуникаций
  - Токены JWT с коротким временем жизни для авторизации API
  - Политики безопасности паролей в соответствии с NIST SP 800-63B
  - Защита от основных векторов атак (OWASP Top 10)
  - Регулярные проверки безопасности и пентесты

### 7.3 Хранение данных и кэширование

- **Основная база данных**:
  - PostgreSQL как основной источник данных с расширенной схемой для поддержки бизнес-логики
  - Реализация партиционирования таблиц для оптимизации производительности
  - Схема базы данных с оптимизированными индексами для эффективного поиска
  - Механизмы аудита для отслеживания изменений важных данных
  - Стратегия миграций базы данных с поддержкой версионирования и отката изменений

- **Кэширование и повышение производительности**:
  - Redis для кэширования часто запрашиваемых данных и снижения нагрузки на основную БД
  - Распределенные транзакционные блокировки через Redis для предотвращения гонок данных
  - Кэширование сессий пользователей и токенов аутентификации
  - Очереди сообщений для асинхронной обработки тяжелых операций (через Redis Streams или RabbitMQ)
  - Стратегии инвалидации кэша для обеспечения консистентности данных

- **Хранение медиафайлов**:
  - MinIO как S3-совместимое хранилище для загружаемых фото, документов и других бинарных данных
  - Автоматическое создание нескольких версий изображений разного размера для оптимизации загрузки
  - Политики хранения для автоматического архивирования старых данных
  - Механизм дедупликации для экономии дискового пространства
  - Контроль версий медиафайлов для отслеживания изменений

### 7.4 Интеграция и коммуникация

- **API Gateway**:
  - API Gateway (например, на базе Kong или Traefik) для централизованного управления доступом к сервисам
  - Единая точка входа для всех клиентских запросов с маршрутизацией к соответствующим микросервисам
  - Ограничение скорости запросов (rate limiting) для защиты от DDoS-атак
  - Аутентификация и авторизация запросов на уровне шлюза
  - Сбор метрик и логирование всех API-вызовов

- **Межсервисное взаимодействие**:
  - gRPC для синхронного взаимодействия между микросервисами с высокой производительностью
  - REST API для интеграции с внешними системами и обратной совместимости
  - События (Event Sourcing) через Apache Kafka или NATS для асинхронной коммуникации
  - Стратегии обработки отказов и повторных попыток для повышения отказоустойчивости
  - Трассировка распределенных запросов с использованием OpenTelemetry для диагностики проблем

- **Внешние интеграции**:
  - Интеграция с почтовыми серверами через SMTP/IMAP для автоматической отправки отчетов
  - Коннекторы к CRM и ERP системам через их API
  - Webhooks для уведомления внешних систем о важных событиях
  - Интеграция с системами геолокации для оптимизации маршрутов
  - Поддержка экспорта данных в различные форматы (PDF, Excel, CSV)

### 7.5 Мониторинг и обслуживание

- **Мониторинг системы**:
  - Prometheus для сбора метрик производительности и бизнес-показателей
  - Grafana для визуализации метрик и построения информационных панелей
  - Алертинг на базе Alertmanager для оповещения о критических событиях
  - ELK Stack (Elasticsearch, Logstash, Kibana) для централизованного логирования
  - Jaeger или Zipkin для трассировки распределенных запросов

- **Операционное обслуживание**:
  - Автоматизированное развертывание через CI/CD pipelines (например, GitLab CI или GitHub Actions)
  - Инфраструктура как код (IaC) с использованием Terraform или Pulumi
  - Автоматизированное обновление компонентов системы без простоя (zero-downtime updates)
  - Резервное копирование данных с политикой хранения и проверкой целостности
  - Планы аварийного восстановления и процедуры переключения на резервные системы

## 8. План миграции и развертывания

### 8.1 Этапы миграции

1. **Подготовительный этап**:
   - Аудит существующих систем и данных
   - Создание тестовой среды
   - Разработка планов миграции и отката
   - Подготовка инфраструктуры

2. **Пилотное внедрение**:
   - Развертывание в ограниченном масштабе с выбранной группой пользователей
   - Сбор обратной связи и устранение выявленных проблем
   - Доработка системы на основе опыта пилотного внедрения

3. **Поэтапное расширение**:
   - Последовательное подключение групп пользователей
   - Параллельная работа с существующими системами в переходный период
   - Постепенная миграция исторических данных

4. **Полное развертывание**:
   - Окончательный переход всех пользователей на новую систему
   - Вывод из эксплуатации старых систем
   - Архивация исторических данных

### 8.2 Контрольные точки и критерии успеха

- Определение KPI для оценки успешности внедрения:
  - Скорость обработки заявок
  - Удовлетворенность пользователей
  - Время простоя системы
  - Количество ошибок и инцидентов

- План реагирования на проблемы:
  - Процедуры отката изменений
  - Команда быстрого реагирования
  - Каналы коммуникации для пользователей

## 9. Обучение и документирование

### 9.1 Обучение пользователей

- **Программа обучения для разных категорий пользователей**:
  - Базовое обучение для всех пользователей
  - Расширенное обучение для администраторов и продвинутых пользователей
  - Специализированное обучение для технической поддержки

- **Материалы для обучения**:
  - Руководства пользователей в электронном формате
  - Видеоуроки для основных функций системы
  - Интерактивные обучающие программы внутри приложения

### 9.2 Техническая документация

- **Документация для разработчиков**:
  - Архитектурная документация
  - Спецификация API
  - Руководства по расширению системы

- **Документация для администраторов**:
  - Руководство по развертыванию
  - Инструкции по обслуживанию и мониторингу
  - Процедуры резервного копирования и восстановления

## 10. Планы дальнейшего развития

### 10.1 Потенциальные расширения функциональности

- Интеграция с AI для автоматического распознавания проблем по фотографиям
- Мобильные приложения для клиентов со статусами их заявок
- Расширенная аналитика и бизнес-отчеты
- AR-функциональность для удаленной поддержки техников
- Интеграция с IoT устройствами для автоматического мониторинга

### 10.2 Дорожная карта развития

- **Краткосрочные цели** (до 6 месяцев после запуска):
  - Стабилизация системы
  - Расширение базовой функциональности
  - Оптимизация производительности

- **Среднесрочные цели** (6-18 месяцев):
  - Интеграция с дополнительными внешними системами
  - Расширенная аналитика и отчетность
  - Улучшение пользовательского опыта на основе собранной обратной связи

- **Долгосрочные цели** (от 18 месяцев):
  - Внедрение AI/ML компонентов
  - Географическое расширение
  - Разработка экосистемы плагинов и расширений

# Спецификация Требований к Программному Обеспечению для Brige Service Management

## 1. Введение

### 1.1 Цель документа
Данный документ описывает функциональные и нефункциональные требования к разработке системы Brige Service Management, предназначенной для автоматизации учёта сервисных работ на объектах клиентов. 

Целью системы является упрощение процесса регистрации выполненных работ, управление заявками, хранение медиаданных и интеграция с внешними сервисами. Документ служит основой для разработки, тестирования и внедрения системы, а также для обеспечения соответствия требованиям безопасности и производительности.

### 1.2 Область применения
Система Brige Service Management будет размещена на защищённом домене и предназначена для использования только авторизованными сотрудниками компании. Основные функции системы:
- Ведение учёта и регистрации выполненных работ.
- Управление заявками, распределение задач и хранение медиаданных (изображений, документов).
- Фиксации снимков, описаний и другой информации, необходимой для анализа и планирования работ.
- Организации рабочего процесса.

### 1.3 Определения, сокращения и аббревиатуры
- SRS – Спецификация Требований к Программному Обеспечению.
- GDPR – Общий регламент защиты данных.
- SSL – Технология шифрования данных.
- API – Интерфейс для взаимодействия приложений.
- Keycloak – платформа для управления аутентификацией и авторизацией, используемая для единого SSO и разграничения доступа.
- PostgreSQL – реляционная система управления базами данных, выбранная для хранения основных данных системы.
- Redis – хранилище данных в памяти, используемое для кэширования и ускорения доступа к часто запрашиваемой информации.
- Brige Service Management – система для автоматизации и учёта работ на объектах клиентов.
- Brige Client – кроссплатформенное клиентское приложение для доступа к функционалу системы.

## 2. Общее описание системы

### 2.1 Общий взгляд на систему
Brige Service Management – это новая система, которая заменяет текущие ручные процессы управления заявками, выдачи заказ-нарядов на выполнение работ, регистрации выполненных работ и других рабочих процессов компании. 

Система будет включать в себя клиентское приложение (Brige Client) для мобильных устройств, а также администраторский интерфейс для управления пользователями и настройками системы.

В контексте данного  документа под системой понимается взаимосвязанная структура, состоящая из следующих компонентов:
  -	сервиса управления заявками, в том числе:
    -	регистрации заявок
    -	выдачи заказ-нарядов на выполнение работ исполнителям
    -	управления приоритетами и сроками выполнения заявок
    - отслеживания статуса выполнения задач
    -	анализе выполненных работ
  -	сервиса управления пользователями, в том числе:
    -	аутентификации и авторизации пользователей
    -	регистрации пользователей
    -	управления ролями и правами доступа
  -	сервиса управления работами, в том числе:
    - регистрации выполненных работ
    -	учёта использованных материалов
    -	загрузки фотографий и документов, подтверждающих выполненные работы
    -	подтверждения выполненных работ клиентами
    -	заказа материалов и оборудования
  -	сервиса управления данными, в том числе:
    -	хранения и аналитической обработки заявок, работ и медиаданных
    -	обеспечения безопасности данных (шифрование, авторизация)
  -	сервиса отчётности, в том числе:
    -	формирования отчётов по заявкам, работам и пользователям
    -	экспорта данных в различные форматы (PDF, Excel)
  -	сервиса интеграции с внешними системами, в том числе:
    -	интеграции с почтовым сервером для отправки отчётов
  -	мобильного приложения Brige Client, для IOS, Android, Windows и Linux
  -	сервиса мониторинга и логирования (вторая очередь), в том числе:
    -	мониторинга состояния системы и производительности
    -	логирования событий и ошибок для диагностики и устранения неисправностей
  -	сервиса уведомлений (вторая очередь), в том числе:
    -	отправки уведомлений пользователям о статусе заявок и выполненных работах
    -	корпоративный чат для обмена сообщениями между пользователями

Система будет разрабатываться с использованием современных технологий и подходов, включая микросервисную архитектуру, контейнеризацию и облачные решения. Основное внимание будет уделено безопасности, производительности и удобству использования.

### 2.2. Классы и характеристики пользователей
| Класс пользователей | Описание                                                            |
| ------------------- | ------------------------------------------------------------------- |
| ***Клиент (обычный)***    | Клиент - это авторизованный пользователь ПО Brige Client, который может самостоятельно регистрировать заявки на выполнение работ в системеме, отслеживать прогресс их выполнения, а также подтвержать фактическое выполнение работ и оставлять отзывы. |
| ***Сервисный техник*** | Сервисный техник - это авторизованный пользователь ПО Brige Client, который получает заявки на выполнение сервисных работ и может регистрировать выполненные работы, загружать медиаданные, изменять статус заявки, оформлять заявки руководству компании на сырье и материалы, необходимые для выполнения работ |
| ***Менеджер по продажам*** | Менеджер по продажам - это авторизованный пользователь ПО Brige Client, который занимается исследованием потребностей клиентов, предлагает решения и услуги компании, а также может регистрировать заявки на выполнение работ. |
| ***Оператор*** | Оператор - это авторизованный пользователь ПО Brige Client, который имеет доступ к административной части ПО и может управлять пользователями, настраивать права доступа, просматривать отчёты и статистику по выполненным работам. Оператор также рассматривает заявки на выполнение работ, распределяет их между сервисными техниками и контролирует их выполнение, а также может взаимодействовать с клиентами для уточнения деталей заявок и получения обратной связи. |
| ***Администратор*** | Администратор - это авторизованный пользователь, который имеет полный доступ к системе, включая управление пользователями, настройку интеграции с внешними сервисами, мониторинг состояния системы и управление безопасностью. Администратор также отвечает за техническую поддержку и решение проблем пользователей. |

### 2.3 Операционная среда
Операционная среда, на которой развернута система, должна удовлетворять следующим требованиям:

#### OC-1. Операционная система 
Система будет работать на современных операционных системах, таких как Linux (например, Ubuntu, CentOS) для серверной части и Android, iOS, Windows и Linux для клиентского приложения Brige Client.
#### OC-2. Среда запуска приложений
Система будет развернута на сервере с поддержкой современных веб-технологий, включая поддержку HTTPS и SSL для обеспечения безопасности передачи данных. 
#### OC-3. База данных
Система будет использовать PostgreSQL в качестве основной базы данных для хранения заявок, работ, пользователей и медиаданных. Redis будет использоваться для кэширования часто запрашиваемой информации и ускорения доступа к данным.
#### OC-4. Веб-сервер
Система будет использовать собственный веб-сервер, либо Nginx или Apache, в качестве обратного прокси-сервера для обработки входящих запросов и маршрутизации их к соответствующим микросервисам. Веб-сервер будет настроен для работы с HTTPS и SSL, обеспечивая безопасность передачи данных между клиентами и сервером.
#### OC-5. Мобильное приложение Brige Client
Brige Client будет разработан с использованием Flutter, что обеспечит кроссплатформенность и возможность работы на Android, iOS, Windows и Linux. 
#### OC-6. Контейнеризация и оркестрация
Система будет развернута в контейнерах с использованием Docker, что обеспечит изоляцию сервисов и упрощение процесса развертывания. Kubernetes будет использоваться для оркестрации контейнеров, управления масштабированием и обеспечения высокой доступности системы.
#### OC-7. Интерфейсы обмена данными
Система будет интегрирована с корпоративными сервисами почты и др. через RESTful API. Для межсервисного взаимодействия будет использоваться gRPC или REST API, что обеспечит гибкость и масштабируемость системы.
#### OC-8. Безопасность
Система будет размещена на защищённом домене с использованием SSL-сертификатов для шифрования данных. Авторизация пользователей будет осуществляться через Keycloak, что обеспечит централизованное управление пользователями и поддержку SSO (единой точки входа). Все данные будут храниться в соответствии с требованиями GDPR, включая шифрование персональных данных (при их наличии в системе) и ограничение доступа к ним.
#### OC-9. Мониторинг и логирование
Система будет включать сервис мониторинга и логирования, который будет отслеживать состояние системы, производительность и ошибки. Логи будут храниться в централизованном хранилище для последующего анализа и диагностики проблем. Для мониторинга состояния системы будет использоваться Prometheus или аналогичный инструмент, а для визуализации данных - сервис Grafana.

### 2.4 Предположения и зависимости
- Система должна быть доступна только авторизованным пользователям.
- Приложение Brige Client нормально функционирует только при условии, что серверная часть системы нормально функционирует и доступна посресредством сети Интернет.
- Пользователи должны иметь стабильное интернет-соединение для работы с системой в момент загрузки медиаданных и синхронизации данных.
- На устройствах пользователей должно быть достаточно свободного места для хранения данных приложения Brige Client, включая медиаданные.

### 2.5 Ограничения
- Система должна быть доступна только через защищённый веб-интерфейс (SSL-шлюз).
- Авторизация пользователей осуществляется по логину и паролю.
- Обработка и хранение данных должны соответствовать требованиям европейских стандартов.
- Система должна обеспечивать возможность работы в офлайн-режиме для мобильного клиента Brige Client, с последующей синхронизацией данных при восстановлении соединения.
- Работа системы не должна приводить к значительному расходу заряда батареи мобильных устройств, особенно в офлайн-режиме и при слабом покрытии сети. 

## 3. Системные функции
### 3.1 Регистрация заявок
- Система должна обеспечивать автоматическую генерацию уникального номера обращения/заказа при её создании.
- Пользователи с ролью "Оператор", либо "Менеджер по продажам" должны иметь возможность вводить данные о заявке, включая:
  - Имя клиента
  - Название компании клиента
  - Адрес клиента
  - Контактное лицо клиента
  - Контактный номер клиента
- Пользователи с ролью "Оператор" должны иметь возможность вводить данные о сервисном технике, включая:
  - Имя техника
  - Название компании (BRIGE, BRIGE Service UG, Conveyor System UG и т.д.)
  - Планируемая дата визита
  - Планируемое время прибытия 
- Система должна поддерживать возможность выбора типа планируемой работы:
  - Установка
  - Ремонт
  - Техническое обслуживание
  - Осмотр
  - Коммерческий визит
  - Консультация
  - Другое (с возможностью ввода текстового описания)
### 3.2 Регистрация выполненных работ
- Система должна позволять пользователям с ролью "Сервисный техник" регистрировать выполненные работы, включая текстовое описание, использованные материалы и дополнительные задачи.
- Система должна поддерживать возможность указания срочности дополнительных работ (низкая, средняя, высокая, критическая).
- Система должна поддерживать возможность загрузки медиаданных (фотографий, документов) для подтверждения выполненных работ.
- Система должна автоматически фиксировать время начала и завершения работы.
### 3.3 Подтверждение выполненной работы
- Система должна предоставлять форму для подтверждения успешности выполнения работы, включая возможность ввода комментариев клиента.
- Система должна поддерживать получение цифровой подписи клиента для подтверждения выполненных работ.
### 3.4 Отправка отчётов
- Система должна автоматически отправлять заполненные формы и отчёты на сервер, а также на указанный корпоративный адрес *info@brige.de* 







### *1. Общая информация*
- *Номер обращения/заказа* (генерируется автоматически)
- *Имя клиента*
- *Название компании клиента*
- *Адрес клиента*
- *Контактное лицо клиента*
- *Контактный номер клиента*

---

### *2. Информация о технике/менеджере по продажам
- *Имя техника/менеджера по продажам*
- *Компания* (BRIGE, BRIGE Service UG, Conveyor System UG и т.д.)
- *Дата визита*
- *Время прибытия / Время ухода*
- *Тип выполненной работы:* (флажки)
  - Установка
  - Ремонт
  - Техническое обслуживание
  - Осмотр
  - Коммерческий визит
  - Консультация
  - Другое (текстовое поле)

---  

### *3. Детали выполненных работ*
- *Описание выполненных работ* (текстовое поле)
- *Используемые материалы* (выпадающий список или список с выбором нескольких вариантов)
- *Требуется ли дополнительная работа?* (Да/Нет)
- *Описание дополнительной работы* (текстовое поле)
- *Срочность дополнительной работы* (выпадающий список: Низкая, Средняя, Высокая, Критическая)

---

### *4. Загрузка медиафайлов*
- *Загрузить фотографии выполненной работы* (множественная загрузка изображений)
- *Загрузить дополнительные документы* (если необходимо) (PDF, Word или Excel)

---

### *5. Подтверждение и подпись клиента*
- *Была ли работа успешно выполнена?* (Да/Нет)
- *Комментарии клиента* (текстовое поле)
- *Имя клиента* (для подписи)
- *Подпись клиента* (поле для цифровой подписи)

---

### *6. Отправка и отчётность*
- *Кнопка отправки:* При её нажатии выполняются следующие действия:
  - Отправка электронного письма с деталями формы, изображениями и подписью на адрес info@brige.de
  - Опциональное создание PDF-файла для документации










### 2.2 Основные функции системы
- **Регистрация заявок:** автоматическая генерация уникальных номеров заявок с возможностью ввода данных о клиенте и сотруднике.
- **Учет работ:** выбор типа выполняемой работы (установка, ремонт, техническое обслуживание и т.д.), подробное описание выполненных работ, выбор использованных материалов.
- **Работа с медиаданными:** загрузка фотографий и дополнительных документов, подтверждающих выполненные работы.
- **Подтверждение выполненной работы:** получение комментариев или цифровой подписи клиента.
- **Отправка отчётов:** автоматическая рассылка заполненных форм и отчётов на указанный корпоративный адрес.
- **Разграничение доступа:** наличие как минимум двух вариантов доступа – клиентский (Brige Client) для сервисных техников и пользователей, а также админский для администраторов системы.
### 2.3 Пользовательские характеристики
- **Клиентский доступ (Brige Client):** 
  - Сервисные техники, менеджеры и другие конечные пользователи используют Brige Client для регистрации заявок, фиксирования выполненных работ и загрузки медиаданных.
  - Доступ предусматривает функционал ввода, просмотра отчётов и работу в офлайн-режиме с последующей синхронизацией.
- **Администраторский доступ:**  
  - Администраторы системы, ответственные за управление пользователями, контроль доступа, настройку интеграции с внешними сервисами и мониторинг состояния системы.
  - Админская панель обеспечивает расширенный функционал для управления системой, конфигурации Keycloak и аварийного восстановления.

### 2.4 Ограничения системы
- Доступ к системе осуществляется только через защищённый веб-интерфейс (SSL-шлюз).
- Авторизация пользователей осуществляется по паролю или с использованием корпоративных механизмов SSO (например, с использованием Keycloak).
- Обработка и хранение данных должна соответствовать требованиям GDPR.
- Высокая нагрузка не должна приводить к значительному замедлению производительности (время отклика не более 3 секунд).

### 2.5 Предположения и зависимости
- Пользователи обладают стабильным интернет-соединением (при этом Brige Client должен корректно обрабатывать ситуации отсутствия или слабого сигнала).
- Серверное оборудование соответствует современным стандартам безопасности и производительности.
- Система интегрирована с корпоративными сервисами почты, CRM и ERP.

## 3. Специфические требования

### 3.1 Функциональные требования

#### 3.1.1 Регистрация заявок и ввод данных
- Автоматическая генерация уникального номера заявки.
- Ввод информации о клиенте: имя, контактные данные, адрес.
- Ввод информации о сотруднике: имя, должность, время начала и завершения работы.
- Возможность выбора типа работы (например, установка, ремонт, техническое обслуживание, осмотр, коммерческий визит, консультация, другое).

#### 3.1.2 Детальное описание выполненных работ
- Текстовое поле для описания выполненных работ.
- Возможность выбора и указания использованных материалов.
- Опция постановки дополнительных задач с возможностью указания срочности (низкая, средняя, высокая, критическая).

#### 3.1.3 Загрузка медиаданных
- Загрузка изображений выполненных работ с возможностью множественной загрузки.
- Загрузка дополнительных документов (PDF, DOCX, Excel).

#### 3.1.4 Подтверждение выполненных работ
- Форма для подтверждения успешности выполнения работы.
- Ввод комментариев клиента и получение цифровой подписи.

#### 3.1.5 Отправка и архивирование данных
- Автоматическая отправка заполненной формы на корпоративный адрес.
- Опция формирования PDF-отчёта для внутреннего архивирования.

#### 3.1.6 Работа в офлайн-режиме мобильного клиента (Brige Client)
- Brige Client должен обеспечивать возможность работы в офлайн-режиме при отсутствии интернет-соединения.
- Локальное хранение данных (например, с использованием SQLite, Hive или аналогичного решения) для записи введенной информации до её синхронизации с сервером.
- Автоматическая или ручная синхронизация данных с сервером при восстановлении соединения, с применением механизмов разрешения конфликтов, если они возникают.

### 3.2 Нефункциональные требования

#### 3.2.1 Безопасность
- Размещение системы на защищённом домене с использованием SSL.
- Авторизация пользователей (пароль или SSO) с интеграцией Keycloak для централизованного управления пользователями.
- Ограничение доступа согласно ролям (клиентский доступ для Brige Client и администраторский доступ для управления системой).
- Соответствие требованиям GDPR для хранения и обработки персональных данных.
- Защита от несанкционированного доступа.

#### 3.2.2 Производительность
- Быстрый отклик системы (не более 3 секунд).
- Поддержка одновременной работы множества пользователей.

#### 3.2.3 Удобство использования
- Интуитивно понятный интерфейс с минимальным количеством шагов.
- Адаптивный дизайн для корректного отображения на любых устройствах.
- Эффективная навигация между разделами системы.

#### 3.2.4 Надёжность
- Регулярное резервное копирование всех данных.
- Логирование событий и ошибок для быстрого устранения неисправностей.
- Возможность восстановления данных в случае сбоев.

#### 3.2.5 Энергоэффективность
- Brige Client должен быть оптимизирован для минимального расхода заряда батареи, особенно в режиме офлайн и при слабом покрытии сети.
- Фоновые процессы синхронизации должны выполняться с минимальным воздействием на потребление энергии.

### 3.3 Требования к интерфейсам

#### 3.3.1 Пользовательский интерфейс
- Современный, минималистичный дизайн с акцентом на удобство ввода данных.
- Экраны ввода, кнопки, выпадающие списки и чекбоксы, оптимизированные под мобильные устройства.
- Интерфейс Brige Client, разработанного на Flutter, должен быть интуитивно понятным и согласованным со схемой дизайна для десктопных и веб-платформ.
- Админский интерфейс должен предоставлять расширенный функционал для управления пользователями, настройками системы (включая конфигурацию Keycloak) и мониторинга.

#### 3.3.2 Интеграция и API
- API для взаимодействия с корпоративной CRM и ERP системами.
- Интеграция с почтовым сервером для автоматической отправки отчётов.
- Возможность экспорта данных в формате PDF для архивирования.

## 4. Системные и аппаратные требования
- Сервер с установленным SSL-сертификатом.
- Совместимость с современными веб-браузерами (Chrome, Firefox, Edge, Safari).
- Выделенные ресурсы для обеспечения высокой производительности.
- Мобильная совместимость для корректной работы на смартфонах и планшетах.
- Сервер и инфраструктура должны поддерживать синхронизацию данных из офлайн-режима Brige Client.

## 5. План реализации и тестирования

### 5.1 Этапы разработки
- Сбор и анализ требований.
- Разработка макета и составление прототипа интерфейса.
- Реализация функционала регистрации заявок, ввода данных и загрузки файлов.
- Интеграция с почтовым сервером и корпоративными API.
- Реализация механизма офлайн-работы Brige Client и синхронизации данных.
- Внедрение разграничения доступа с клиентскими и администраторскими учетными записями.
- Интеграция Keycloak для управления пользователями и единой аутентификации.
- Развертывание микросервисов в контейнерах (например, Docker) с оркестрацией с помощью Kubernetes.
- Проведение функционального тестирования и устранение обнаруженных ошибок.
- Тестирование производительности, безопасности, энергоэффективности и удобства использования.
- Развертывание системы на защищённом домене и ввод в эксплуатацию.

### 5.2 Тестирование
- Функциональное тестирование всех ключевых сценариев (регистрация, редактирование, отправка).
- Тестирование безопасности (проверка авторизации, разграничения доступа, защиты данных, интеграции с Keycloak и соответствия требованиям GDPR).
- Нагрузочное тестирование при высокой одновременной активности пользователей.
- Тестирование механизма офлайн-синхронизации, включая сценарии разрешения конфликтов.
- Тестирование энергоэффективности Brige Client, с оценкой влияния фоновых процессов на расход батареи.
- Интеграционное тестирование взаимодействия с внешними API и почтовой системой.
- Тестирование процессов развертывания и обновления микросервисов в Kubernetes.

## 6. Приложения

### 6.1 Дополнительные документы
- Примеры заполнения форм и отчётов.
- Диаграммы бизнес-процессов и пользовательских сценариев.
- Список терминов и сокращений, используемых в документе.

## 7. Технический стэк и архитектурное решение

В качестве основы для реализации системы предлагается следующий подход:

### 7.1 Общая архитектура

Система построена на основе трёхуровневой архитектуры, которая включает следующие компоненты:

1. **Клиентский уровень (Presentation Layer, frontend)**:
   - Это пользовательский интерфейс, через который сотрудники компании взаимодействуют с системой - мобильное приложение Brige Client.
   - Основная задача клиента — отправка данных на обработку и отображение результатов работы системы.
   - Brige Client будет поддерживать режим офлайн с локальным хранением данных и последующей синхронизацией с сервером.
   - Рекомендуется применение одного из современных подходов к управлению состоянием (Provider, BLoC или Riverpod) для обеспечения чистой архитектуры приложения.
   - Особое внимание уделяется оптимизации энергопотребления, чтобы приложение не разряжало батарею, особенно при слабом покрытии сети.   
   - Клиентское приложение рекомендуется разрабатывать с использованием Flutter. Flutter позволит создать единое решение для мобильных устройств (Android, iOS), а также для десктопных систем (Windows, Linux) и веб-интерфейса.

2. **Серверный уровень (Application Layer, backend)**:
   - Сердце системы, где выполняется основная логика обработки данных.
   - Включает в себя микросервисы, разработанные на Go (Golang), которые выполняют отдельные задачи, такие как:
     - Управление заявками.
     - Загрузка и обработка медиафайлов.
     - Интеграция с внешними системами (CRM, ERP и почтовыми сервисами).
     - Управления пользователями с разграничением доступа по ролям.
   - Golang выбран за его высокую производительность, встроенную поддержку конкурентности и простоту развертывания в контейнерах.
   - Микросервисы разворачиваются в контейнерах (например, с использованием Docker) с дальнейшей оркестрацией и управлением через Kubernetes. Это решение обеспечивает автономность, масштабируемость и лёгкость обновления отдельных сервисов.
   - Для взаимодействия между микросервисами рекомендуется использовать протокол gRPC для эффективной и быстрой коммуникации или REST API для интеграции с внешними сервисами.
   - Интеграция Keycloak для управления пользователями, реализации единого входа (SSO) и разграничения доступа.
   - Keycloak позволяет централизованно управлять аутентификацией и авторизацией для всех микросервисов и клиентских приложений.

3. **Уровень базы данных (Database Layer)**:
   - Здесь хранятся все данные системы, включая заявки, файлы и пользовательскую информацию.
   - База данных оптимизирована для высокой производительности и масштабируемости, чтобы справляться с большими объёмами информации.
   - Основные компоненты:
     - Реляционная БД PostgreSQL для хранения структурированных данных о заявках, клиентах, пользователях
     - Объектное хранилище MinIO для эффективного хранения медиафайлов (фотографии, документы)
     - TimescaleDB для хранения временных рядов (метрики, логи, аналитика)
   - Стратегия репликации и шардирования данных для обеспечения высокой доступности и горизонтальной масштабируемости

### 7.2 Управление пользователями и безопасность

- **Централизованное управление идентификацией**:
  - Keycloak как основа системы управления пользователями и их доступом (IAM)
  - Интеграция с корпоративными каталогами (LDAP, Active Directory) для единого входа
  - Поддержка многофакторной аутентификации для повышенной безопасности
  - Возможность федеративной аутентификации через SAML, OAuth 2.0, OpenID Connect
  - Настраиваемые потоки аутентификации для разных категорий пользователей

- **Ролевая модель доступа**:
  - Основные роли: администратор, руководитель, техник, клиент